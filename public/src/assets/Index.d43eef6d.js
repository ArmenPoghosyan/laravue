import{p as M,V as G,X,b as B,q as V,C as Z,aG as J,bz as W,bA as Y,bc as $,s as aa,bi as ea,bj as la,_ as ta,y as U,f as s,B as oa,A as na,r as u,o as g,c as v,w as d,ab as n,g as C,t as k,n as sa,aZ as q,d as z,e as T,F as x,aN as L,a_ as N,aR as j}from"./index.efdacdc2.js";import{C as A}from"./ClosePopup.7b950a27.js";var ia=M({name:"QBreadcrumbsEl",props:{...G,label:String,icon:String,tag:{type:String,default:"span"}},emits:["click"],setup(a,{slots:l}){const{linkTag:m,linkAttrs:e,linkClass:f,navigateOnClick:w}=X(),c=B(()=>({class:"q-breadcrumbs__el q-link flex inline items-center relative-position "+(a.disable!==!0?"q-link--focusable"+f.value:"q-breadcrumbs__el--disable"),...e.value,onClick:w})),_=B(()=>"q-breadcrumbs__el-icon"+(a.label!==void 0?" q-breadcrumbs__el-icon--with-label":""));return()=>{const r=[];return a.icon!==void 0&&r.push(V(Z,{class:_.value,name:a.icon})),a.label!==void 0&&r.push(a.label),V(m.value,{...c.value},J(l.default,r))}}});const da=["",!0];var ra=M({name:"QBreadcrumbs",props:{...W,separator:{type:String,default:"/"},separatorColor:String,activeColor:{type:String,default:"primary"},gutter:{type:String,validator:a=>["none","xs","sm","md","lg","xl"].includes(a),default:"sm"}},setup(a,{slots:l}){const m=Y(a),e=B(()=>`flex items-center ${m.value}${a.gutter==="none"?"":` q-gutter-${a.gutter}`}`),f=B(()=>a.separatorColor?` text-${a.separatorColor}`:""),w=B(()=>` text-${a.activeColor}`);return()=>{const c=$(aa(l.default));if(c.length===0)return;let _=1;const r=[],b=c.filter(i=>i.type!==void 0&&i.type.name==="QBreadcrumbsEl").length,t=l.separator!==void 0?l.separator:()=>a.separator;return c.forEach(i=>{if(i.type!==void 0&&i.type.name==="QBreadcrumbsEl"){const p=_<b,h=i.props!==null&&da.includes(i.props.disable),E=(p===!0?"":" q-breadcrumbs--last")+(h!==!0&&p===!0?w.value:"");_++,r.push(V("div",{class:`flex items-center${E}`},[i])),p===!0&&r.push(V("div",{class:"q-breadcrumbs__separator"+f.value},t()))}else r.push(i)}),V("div",{class:"q-breadcrumbs"},[V("div",{class:e.value},r)])}}});function ca(a){const l=document.createElement("textarea");l.value=a,l.contentEditable="true",l.style.position="fixed";const m=()=>{};ea(m),document.body.appendChild(l),l.focus(),l.select();const e=document.execCommand("copy");return l.remove(),la(m),e}function ua(a){return navigator.clipboard!==void 0?navigator.clipboard.writeText(a):new Promise((l,m)=>{const e=ca(a);e?l(!0):m(e)})}const pa={setup(){const a=U({language:s.state.user.language,id:null,path:null,list:[],loading:!1}),l=U({show:!1,loading:!1,selected_language:"en",data:{id:null,language:null,parent_id:null,type:"value",label:"",key:"",value:s.spreadLanguages()}}),m=[{name:"type",align:"left",label:"",field:"type",sortable:!0,style:"width: 20px",headerStyle:"width: 20px"},{name:"key",align:"left",label:s.locale.t("pages.localizations.key"),field:"key",sortable:!0},{name:"label",align:"left",label:s.locale.t("pages.localizations.label"),field:"label",sortable:!0},{name:"value",align:"left",label:s.locale.t("pages.localizations.value"),field:"value",sortable:!0},{name:"actions",align:"right",label:"",field:"actions",sortable:!1}],e=[{value:"value",label:s.locale.t("pages.localizations.value")},{value:"node",label:s.locale.t("pages.localizations.node")}];oa(()=>{const t=s.router.currentRoute.value.params.id;t&&(a.value.id=t,l.value.data.parent_id=t),f()}),na(s.router.currentRoute,t=>{const i=t.params.id;i!=a.value.id&&(a.value.id=i,l.value.data.parent_id=i,f())});async function f(){let t=null;if(a.value.loading=!0,a.value.id?t=await s.store.dispatch("localization/show",{id:a.value.id,language:a.value.language}):t=await s.store.dispatch("localization/index"),t&&t.status){a.value.list=t.localizations;let i=[{id:null,key:"root"}];t.path?a.value.path=[...i,...t.path]:a.value.path=i}a.value.loading=!1}async function w(){s.clearErrors(),l.value.loading=!0;let t=null;l.value.data.id?t=await s.store.dispatch("localization/update",l.value.data):t=await s.store.dispatch("localization/store",l.value.data),t.status?(l.value.show=!1,f()):t.statusCode==422&&s.setErrors(t==null?void 0:t.errors),l.value.loading=!1}function c(t=null){l.value.show=!0,l.value.loading=!1,s.clearErrors(),l.value.selected_language="en",t?l.value.data={...t}:l.value.data={id:null,language:a.value.language,parent_id:a.value.id,type:"value",label:"",key:"",value:s.spreadLanguages()}}function _(t,i=null){let p=a.value.path.filter(h=>h.id).map(h=>h.key);i&&p.push(i),p=p.join("."),t.ctrlKey?p=`{{ $t('${p}') }}`:t.shiftKey&&(p=`$t('${p}')`),ua(p)}function r(t){async function i(){(await s.store.dispatch("localization/destroy",t.id)).status&&await f()}s.$q.dialog({title:s.locale.t("globals.confirm"),message:s.locale.t("pages.localizations.delete"),cancel:s.locale.t("globals.cancel"),ok:s.locale.t("globals.yes")}).onOk(async()=>{t.type=="node"?s.$q.dialog({title:s.locale.t("globals.please_note"),message:s.locale.t("pages.localizations.delete_node"),cancel:!0}).onOk(i):i()})}async function b(){a.value.sync_loading=!0,(await s.store.dispatch("localization/sync")).status?s.$q.notify({type:"positive",message:s.locale.t("pages.localizations.synced")}):s.$q.notify({type:"negative",message:s.locale.t("pages.localizations.sync_failed")}),a.value.sync_loading=!1}return{state:a,dialog:l,columns:m,localization_types:e,save:w,destroy:r,sync:b,show_dialog:c,copy_path:_}}},ga={class:"text-h6 q-mr-auto"},ma={class:"row items-center q-gap-sm"},fa={class:"row items-center q-gap-sm q-mr-auto"},_a={class:"no-wrap row justify-end q-gap-sm"},ba={class:"text-h6"},ya={key:0,class:"text-negative inline-block q-mb-md"},va={class:"row no-wrap full-width q-gap-md"};function ha(a,l,m,e,f,w){const c=u("ap-button"),_=u("ap-select"),r=u("ap-card-section"),b=u("ap-separator"),t=u("ap-icon"),i=u("ap-td"),p=u("ap-tr"),h=u("ap-table"),E=u("ap-card"),R=u("ap-dialog-header"),P=u("ap-input"),F=u("ap-tab"),O=u("ap-tabs"),D=u("ap-editor"),H=u("ap-dialog-card"),I=u("ap-dialog"),K=u("ap-page");return g(),v(K,null,{default:d(()=>[n(E,null,{default:d(()=>[n(r,{class:"row items-center q-gap-md"},{default:d(()=>[C("span",ga,k(a.$t("pages.localizations.title")),1),C("div",ma,[C("div",fa,[n(c,{size:"sm",label:a.$t("globals.sync"),color:"primary",onClick:e.sync},null,8,["label","onClick"]),n(c,{size:"sm",label:a.$t("globals.create"),color:"primary",onClick:l[0]||(l[0]=o=>e.show_dialog(null))},null,8,["label"])])]),n(_,{"map-options":"","emit-value":"",options:a.lists.languages,modelValue:e.state.language,"onUpdate:modelValue":l[1]||(l[1]=o=>e.state.language=o),class:sa({"full-width":a.$q.screen.lt.sm})},null,8,["options","modelValue","class"])]),_:1}),n(b),n(r,{class:"q-py-sm text-bold row items-center q-gap-sm"},{default:d(()=>{var o;return[q(k(a.$t("pages.localizations.path"))+" ",1),n(ra,{separator:"/"},{default:d(()=>[(g(!0),z(x,null,T(e.state.path,y=>(g(),v(ia,{key:y.key,label:y.key,to:{name:"localizations.index",params:{id:y.id}}},null,8,["label","to"]))),128))]),_:1}),((o=e.state.path)==null?void 0:o.length)>1?(g(),v(c,{key:0,icon:"content_copy",size:"xs",round:"",onClick:e.copy_path},null,8,["onClick"])):L("",!0)]}),_:1}),n(b),n(r,{"no-padding":"",class:"overflow-hidden"},{default:d(()=>[n(h,{"hide-bottom":"",flat:"",columns:e.columns,rows:e.state.list,color:"primary",loading:e.state.loading,pagination:{rowsPerPage:1e3}},{body:d(o=>[n(p,{onClick:y=>o.row.type=="node"?a.$router.push({name:"localizations.index",params:{id:o.row.id}}):e.show_dialog(o.row)},{default:d(()=>{var y,Q;return[n(i,{props:o,key:"type",class:"cursor-pointer"},{default:d(()=>[o.row.type=="value"?(g(),v(t,{key:0,name:"sym_o_line_start_diamond",size:"22px",color:"primary"})):(g(),v(t,{key:1,name:"sym_o_network_node",size:"22px",color:"primary"}))]),_:2},1032,["props"]),n(i,{props:o,key:"key"},{default:d(()=>[q(k(o.row.key),1)]),_:2},1032,["props"]),n(i,{props:o,key:"label"},{default:d(()=>[q(k(o.row.label),1)]),_:2},1032,["props"]),n(i,{props:o,key:"value",innerHTML:((Q=o.row.value)==null?void 0:Q[(y=e.state)==null?void 0:y.language])||""},null,8,["props","innerHTML"]),n(i,{props:o,key:"actions"},{default:d(()=>[C("div",_a,[n(c,{icon:"content_copy",size:"xs",round:"",onClick:N(S=>e.copy_path(S,o.row.key),["stop"])},null,8,["onClick"]),n(c,{icon:"edit",size:"xs",round:"",onClick:N(S=>e.show_dialog(o.row),["stop"])},null,8,["onClick"]),n(c,{icon:"delete",color:"negative",size:"xs",round:"",onClick:N(S=>e.destroy(o.row),["stop"])},null,8,["onClick"])])]),_:2},1032,["props"])]}),_:2},1032,["onClick"])]),_:1},8,["columns","rows","loading"])]),_:1})]),_:1}),n(I,{modelValue:e.dialog.show,"onUpdate:modelValue":l[7]||(l[7]=o=>e.dialog.show=o)},{default:d(()=>[n(H,{style:{"max-width":"700px"}},{default:d(()=>[n(R,null,{default:d(()=>[C("span",ba,[e.dialog.data.id?(g(),z(x,{key:0},[q(k(a.$t("globals.edit")),1)],64)):(g(),z(x,{key:1},[q(k(a.$t("globals.create")),1)],64))]),j(n(c,{flat:"",round:"",class:"q-ml-auto",size:"sm",icon:"close"},null,512),[[A]])]),_:1}),n(b),n(r,{class:"column"},{default:d(()=>[e.dialog.data.id&&e.dialog.data.type=="node"?(g(),z("span",ya,k(a.$t("pages.localizations.node_edit")),1)):L("",!0),C("div",va,[e.dialog.data.id==null?(g(),v(_,{key:0,class:"full-width",label:a.$t("pages.localizations.type"),"map-options":"","emit-value":"",options:e.localization_types,modelValue:e.dialog.data.type,"onUpdate:modelValue":l[2]||(l[2]=o=>e.dialog.data.type=o),validate:"type"},null,8,["label","options","modelValue"])):L("",!0),n(P,{class:"full-width",label:a.$t("pages.localizations.key"),modelValue:e.dialog.data.key,"onUpdate:modelValue":l[3]||(l[3]=o=>e.dialog.data.key=o),validate:"key"},null,8,["label","modelValue"]),n(P,{class:"full-width",label:a.$t("pages.localizations.label"),modelValue:e.dialog.data.label,"onUpdate:modelValue":l[4]||(l[4]=o=>e.dialog.data.label=o),validate:"label"},null,8,["label","modelValue"])])]),_:1}),e.dialog.data.type=="value"?(g(),z(x,{key:0},[n(b),n(r,{"no-padding":""},{default:d(()=>[n(O,{dense:"",modelValue:e.dialog.selected_language,"onUpdate:modelValue":l[5]||(l[5]=o=>e.dialog.selected_language=o),class:"full-width",align:"justify"},{default:d(()=>[(g(!0),z(x,null,T(a.lists.languages,(o,y)=>(g(),v(F,{key:y,"no-caps":!1,name:o.value,label:o.value},null,8,["name","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(r,{"no-padding":""},{default:d(()=>[n(D,{rich:"","no-focus":"",modelValue:e.dialog.data.value[e.dialog.selected_language],"onUpdate:modelValue":l[6]||(l[6]=o=>e.dialog.data.value[e.dialog.selected_language]=o),"min-height":"10rem"},null,8,["modelValue"])]),_:1})],64)):(g(),v(b,{key:1})),n(r,{class:"row items-center justify-between"},{default:d(()=>[j(n(c,{flat:"",label:a.$t("globals.cancel"),color:"primary"},null,8,["label"]),[[A]]),n(c,{label:a.$t("globals.save"),color:"primary",loading:e.dialog.loading,onClick:e.save},null,8,["label","loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var Ca=ta(pa,[["render",ha]]);export{Ca as default};
