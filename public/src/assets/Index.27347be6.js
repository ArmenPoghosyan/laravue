import{C}from"./ClosePopup.fbcc733e.js";import{_ as M,f as n,y as q,r as i,o as y,c as V,w as s,ab as t,g as k,t as u,aN as U,n as z,a_ as Z,aZ as f,aR as N}from"./index.de5baf35.js";import"./moment.9709ab41.js";const x={setup(){const o=n.paginator(20),a=q({list:[],filters:{query:"",type:null,status:null,date:{from:null,to:null}}}),p=q({open:!1,loading:!1,data:{email:"",phone:"",type:"user",birth_date:"",first_name:"",last_name:""}}),l=[{name:"avatar",align:"left",label:n.locale.t("globals.multimedia_types.photo"),sortable:!1,style:"width: 60px",headerStyle:"width: 60px"},{name:"first_name",align:"left",label:n.locale.t("globals.user_fields.first_name"),sortable:!0},{name:"last_name",align:"left",label:n.locale.t("globals.user_fields.last_name"),sortable:!0},{name:"birth_date",align:"left",label:n.locale.t("globals.user_fields.age"),sortable:!0},{name:"phone",align:"left",label:n.locale.t("globals.user_fields.phone"),sortable:!0},{name:"email",align:"left",label:n.locale.t("globals.user_fields.email"),sortable:!0},{name:"type",align:"left",label:n.locale.t("globals.user_fields.type"),sortable:!0},{name:"deleted_at",align:"left",label:n.locale.t("globals.status"),sortable:!0},{name:"created_at",align:"left",label:n.locale.t("globals.user_fields.registration_date"),sortable:!0}],h=[{label:n.locale.t("globals.user_types.admin"),value:"admin"},{label:n.locale.t("globals.user_types.manager"),value:"manager"},{label:n.locale.t("globals.user_types.user"),value:"user"}];async function w(d=null){var g,v;a.value.loading=!0,d||(d={pagination:o.value.reset()});const r=await n.store.dispatch("users/index",{...d.pagination.normalize(),filters:a.value.filters,all:!0});r.status&&(a.value.list=((g=r==null?void 0:r.users)==null?void 0:g.data)||[],d.pagination.setTotal(((v=r==null?void 0:r.users)==null?void 0:v.total)||0)),o.value.fromProps(d.pagination),a.value.loading=!1}function c(){p.value.data={email:"",type:"staff",first_name:"",last_name:""}}function _(){c(),p.value.open=!0}async function b(){p.value.loading=!0,n.clearErrors();const d=await n.store.dispatch("users/store",p.value.data);d.status?(w(),p.value.open=!1):d.statusCode==422?n.setErrors(d.errors):n.$q.notify({type:"negative",message:n.locale.t("globals.errors.unknown")}),p.value.loading=!1}return{state:a,pagination:o,invite:p,columns:l,user_types:h,fetch:w,open_invite:_,invite_user:b}}},F={class:"text-h6 q-mr-auto"},G={class:"row items-center q-col-gutter-md"},H={class:"text-h6 q-mr-auto"};function J(o,a,p,l,h,w){const c=i("ap-button"),_=i("ap-card-section"),b=i("ap-separator"),d=i("ap-icon"),r=i("ap-input"),g=i("ap-select"),v=i("ap-date-picker"),B=i("ap-img"),R=i("ap-avatar"),m=i("ap-td"),A=i("ap-tr"),D=i("ap-table"),E=i("ap-card"),P=i("ap-dialog-header"),S=i("ap-dialog-card"),T=i("ap-dialog"),j=i("ap-page");return y(),V(j,null,{default:s(()=>[t(E,null,{default:s(()=>[t(_,{class:"row items-center q-gap-md"},{default:s(()=>{var e;return[k("span",F,u(o.$t("pages.users.title")),1),((e=o.$user)==null?void 0:e.type)=="admin"?(y(),V(c,{key:0,"hide-label-sm":"",outline:"",color:"primary",icon:"add",label:o.$t("globals.add"),onClick:l.open_invite},null,8,["label","onClick"])):U("",!0)]}),_:1}),t(b),t(_,null,{default:s(()=>[k("div",G,[t(r,{modelValue:l.state.filters.query,"onUpdate:modelValue":[a[0]||(a[0]=e=>l.state.filters.query=e),a[1]||(a[1]=e=>l.fetch())],"no-padding-right":"",debounce:"300",class:z([{"full-width":o.$q.screen.lt.sm},"col-xs-12 col-sm-6 col-md-3 col-lg-2"])},{prepend:s(()=>[t(d,{name:"sym_o_search",size:"24px"})]),_:1},8,["modelValue","class"]),t(g,{modelValue:l.state.filters.type,"onUpdate:modelValue":[a[2]||(a[2]=e=>l.state.filters.type=e),a[3]||(a[3]=e=>l.fetch())],"map-options":"","emit-value":"",options:o.lists.prependAll(o.lists.user_types.value),label:o.$t("globals.user_fields.type"),class:"col-xs-12 col-sm-6 col-md-2 col-lg-1"},null,8,["modelValue","options","label"]),t(g,{modelValue:l.state.filters.status,"onUpdate:modelValue":[a[4]||(a[4]=e=>l.state.filters.status=e),a[5]||(a[5]=e=>l.fetch())],options:o.lists.prependAll(o.lists.user_statuses.value),"map-options":"","emit-value":"",label:o.$t("globals.status"),class:"col-xs-12 col-sm-6 col-md-2 col-lg-1"},null,8,["modelValue","options","label"]),t(v,{modelValue:l.state.filters.date,"onUpdate:modelValue":[a[6]||(a[6]=e=>l.state.filters.date=e),a[7]||(a[7]=e=>l.fetch())],label:o.$t("globals.user_fields.registration_date"),range:"",class:"col-xs-12 col-sm-6 col-md-3 col-lg-2"},null,8,["modelValue","label"])])]),_:1}),t(_,{"no-padding":""},{default:s(()=>[t(D,{name:"users","use-server":"",flat:"",columns:l.columns,rows:l.state.list,loading:l.state.loading,pagination:l.pagination,"onUpdate:pagination":a[8]||(a[8]=e=>l.pagination=e),onRequest:l.fetch},{body:s(e=>[t(A,{class:"cursor-pointer",onClick:I=>o.$router.push({name:"user.index",params:{id:e.row.id}})},{default:s(()=>[t(m,{props:e,key:"avatar"},{default:s(()=>[t(R,{bordered:"",rounded:"",size:"40px"},{default:s(()=>[e.row.avatar?(y(),V(B,{key:0,src:o.media(e.row.avatar,"s"),fit:"cover",class:"fit cursor-pointer",onClick:Z(I=>o.open_media_popup(o.media(e.row.avatar)),["stop","prevent"])},null,8,["src","onClick"])):(y(),V(d,{key:1,name:"sym_o_person",color:"grey-6"}))]),_:2},1024)]),_:2},1032,["props"]),t(m,{props:e,key:"first_name"},{default:s(()=>[f(u(e.row.first_name),1)]),_:2},1032,["props"]),t(m,{props:e,key:"last_name"},{default:s(()=>[f(u(e.row.last_name),1)]),_:2},1032,["props"]),t(m,{props:e,key:"birth_date"},{default:s(()=>[f(u(e.row.age),1)]),_:2},1032,["props"]),t(m,{props:e,key:"phone"},{default:s(()=>[f(u(e.row.phone||"-"),1)]),_:2},1032,["props"]),t(m,{props:e,key:"email"},{default:s(()=>[f(u(e.row.email),1)]),_:2},1032,["props"]),t(m,{props:e,key:"type"},{default:s(()=>[f(u(o.$t(`globals.user_types.${e.row.type}`)),1)]),_:2},1032,["props"]),t(m,{props:e,key:"deleted_at",class:z(["text-uppercase text-weight-bold",{"text-positive":e.row.status=="active","text-negative":e.row.status=="archived"}])},{default:s(()=>[f(u(e.row.status=="active"?o.$t("globals.active"):o.$t("globals.archived")),1)]),_:2},1032,["props","class"]),t(m,{props:e,key:"created_at"},{default:s(()=>[f(u(o.nice_date(e.row.created_at,!0)),1)]),_:2},1032,["props"])]),_:2},1032,["onClick"])]),_:1},8,["columns","rows","loading","pagination","onRequest"])]),_:1})]),_:1}),t(T,{modelValue:l.invite.open,"onUpdate:modelValue":a[15]||(a[15]=e=>l.invite.open=e)},{default:s(()=>[t(S,null,{default:s(()=>[t(P,null,{default:s(()=>[k("span",H,u(o.$t("pages.users.add.title")),1),N(t(c,{icon:"close",size:"12px",round:"",flat:""},null,512),[[C]])]),_:1}),t(b),t(_,{class:"row q-col-gutter-md"},{default:s(()=>[o.$user.type=="admin"?(y(),V(g,{key:0,class:"col-xs-12",label:o.$t("globals.user_fields.type"),options:l.user_types,modelValue:l.invite.data.type,"onUpdate:modelValue":a[9]||(a[9]=e=>l.invite.data.type=e),"map-options":"","emit-value":"",validate:"type"},null,8,["label","options","modelValue"])):U("",!0),t(r,{class:"col-xs-12 col-sm-6",type:"first_name",modelValue:l.invite.data.first_name,"onUpdate:modelValue":a[10]||(a[10]=e=>l.invite.data.first_name=e),label:o.$t("globals.user_fields.first_name"),validate:"first_name"},null,8,["modelValue","label"]),t(r,{class:"col-xs-12 col-sm-6",type:"last_name",modelValue:l.invite.data.last_name,"onUpdate:modelValue":a[11]||(a[11]=e=>l.invite.data.last_name=e),label:o.$t("globals.user_fields.last_name"),validate:"last_name"},null,8,["modelValue","label"]),t(r,{class:"col-xs-12 col-sm-6",type:"email",modelValue:l.invite.data.email,"onUpdate:modelValue":a[12]||(a[12]=e=>l.invite.data.email=e),label:o.$t("globals.user_fields.email"),validate:"email"},null,8,["modelValue","label"]),t(r,{class:"col-xs-12 col-sm-6",modelValue:l.invite.data.phone,"onUpdate:modelValue":a[13]||(a[13]=e=>l.invite.data.phone=e),label:o.$t("globals.user_fields.phone"),validate:"phone"},null,8,["modelValue","label"]),t(v,{modelValue:l.invite.data.birth_date,"onUpdate:modelValue":a[14]||(a[14]=e=>l.invite.data.birth_date=e),class:"col-xs-12 col-sm-6",label:o.$t("globals.user_fields.birth_date"),validate:"birth_date"},null,8,["modelValue","label"])]),_:1}),t(b),t(_,{class:"row items-center justify-between"},{default:s(()=>[N(t(c,{flat:"",label:o.$t("globals.cancel")},null,8,["label"]),[[C]]),t(c,{color:"primary",label:o.$t("globals.add"),loading:l.invite.loading,onClick:l.invite_user},null,8,["label","loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var Q=M(x,[["render",J]]);export{Q as default};
