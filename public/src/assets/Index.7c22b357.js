import{C as g}from"./ClosePopup.7b950a27.js";import{_ as N,y as C,B as j,f as s,a5 as z,r as i,by as D,o as p,c as f,w as d,ab as l,g as _,t as c,aR as u,aN as F,d as q,F as I}from"./index.efdacdc2.js";const M={setup(){const o=C({loading:!1,changed:!1,data:{first_name:"",last_name:"",phone:"",birth_date:""}}),a=C({email:{open:!1,loading:!1,sent:!0,data:{email:""}},password:{open:!1,loading:!1,data:{password:"",password_confirmation:""}}});j(()=>{o.value.data={first_name:s.state.user.first_name,last_name:s.state.user.last_name,birth_date:s.state.user.birth_date,email:s.state.user.email,phone:s.state.user.phone},z(()=>{o.value.changed=!1})});async function b(){o.value.loading=!0,s.clearErrors();const n=await s.store.dispatch("user/update",o.value.data);n.status?(s.$q.notify({type:"positive",message:s.locale.t("globals.saved")}),o.value.changed=!1):n.statusCode==422?s.setErrors(n.errors):s.$q.notify({type:"negative",message:s.locale.t("globals.errors.unknown")}),o.value.loading=!1}function e(){a.value.password.open=!0}function w(){a.value.email.open=!0,a.value.email.sent=!1,a.value.email.loading=!1,a.value.email.data.email=null}async function v(){a.value.password.loading=!0,s.clearErrors();const n=await s.store.dispatch("user/change_password",a.value.password.data);n.status?(a.value.password.open=!1,a.value.password.data={password:"",password_confirmation:""},s.$q.notify({type:"positive",message:s.locale.t("globals.saved")})):n.statusCode==422?s.setErrors(n.errors):s.$q.notify({type:"negative",message:s.locale.t("globals.errors.unknown")}),a.value.password.loading=!1}async function r(){a.value.password.loading=!0,s.clearErrors();const n=await s.store.dispatch("user/change_email",a.value.email.data);n.status?(a.value.email.sent=!0,a.value.email.data={email:""}):n.statusCode==422?s.setErrors(n.errors):s.$q.notify({type:"negative",message:s.locale.t("globals.errors.unknown")}),a.value.email.loading=!1}return{state:o,dialog:a,save:b,open_password_dialog:e,open_email_dialog:w,change_password:v,change_email:r}}},P={class:"text-h6 q-mr-auto"},R={class:"text-h6 q-mr-auto"},S={class:"text-h6 q-mr-auto"},T={key:0,class:"flex flex-center q-pa-md"};function x(o,a,b,e,w,v){const r=i("ap-button"),n=i("ap-card-section"),m=i("ap-input"),U=i("ap-date-picker"),E=i("ap-card"),V=i("ap-dialog-header"),y=i("ap-dialog-card"),h=i("ap-dialog"),B=i("ap-page"),k=D("password");return p(),f(B,null,{default:d(()=>[l(E,null,{default:d(()=>[l(n,{class:"row items-center"},{default:d(()=>[_("span",P,c(o.$t("pages.profile.title")),1),u(l(r,{color:"primary",label:o.$t("pages.profile.change_password"),size:"12px",push:""},null,8,["label"]),[[k,e.open_password_dialog]])]),_:1}),l(n,{class:"row q-col-gutter-md"},{default:d(()=>[l(m,{class:"col-xs-12 col-sm-4",label:o.$t("globals.user_fields.first_name"),modelValue:e.state.data.first_name,"onUpdate:modelValue":[a[0]||(a[0]=t=>e.state.data.first_name=t),a[1]||(a[1]=t=>e.state.changed=!0)],validate:"first_name"},null,8,["label","modelValue"]),l(m,{class:"col-xs-12 col-sm-4",label:o.$t("globals.user_fields.last_name"),modelValue:e.state.data.last_name,"onUpdate:modelValue":[a[2]||(a[2]=t=>e.state.data.last_name=t),a[3]||(a[3]=t=>e.state.changed=!0)],validate:"last_name"},null,8,["label","modelValue"]),l(m,{class:"col-xs-12 col-sm-4",label:o.$t("globals.user_fields.phone"),modelValue:e.state.data.phone,"onUpdate:modelValue":[a[4]||(a[4]=t=>e.state.data.phone=t),a[5]||(a[5]=t=>e.state.changed=!0)],validate:"phone"},null,8,["label","modelValue"]),l(U,{class:"col-xs-12 col-sm-4",label:o.$t("globals.user_fields.birth_date"),modelValue:e.state.data.birth_date,"onUpdate:modelValue":[a[6]||(a[6]=t=>e.state.data.birth_date=t),a[7]||(a[7]=t=>e.state.changed=!0)],validate:"birth_date"},null,8,["label","modelValue"]),u(l(m,{class:"col-xs-12 col-sm-4",label:o.$t("globals.user_fields.email"),modelValue:e.state.data.email,"onUpdate:modelValue":a[8]||(a[8]=t=>e.state.data.email=t)},null,8,["label","modelValue"]),[[k,()=>e.open_email_dialog()]])]),_:1}),l(n,{class:"row items-center justify-end"},{default:d(()=>[e.state.changed?(p(),f(r,{key:0,color:"primary",label:o.$t("globals.save"),onClick:e.save,loading:e.state.loading},null,8,["label","onClick","loading"])):F("",!0)]),_:1})]),_:1}),l(h,{modelValue:e.dialog.password.open,"onUpdate:modelValue":a[11]||(a[11]=t=>e.dialog.password.open=t)},{default:d(()=>[l(y,null,{default:d(()=>[l(V,null,{default:d(()=>[_("span",R,c(o.$t("pages.profile.change_password")),1),u(l(r,{flat:"",round:"",size:"12px",icon:"close"},null,512),[[g]])]),_:1}),l(n,{class:"column q-gap-md"},{default:d(()=>[l(m,{type:"password",label:o.$t("globals.user_fields.password"),modelValue:e.dialog.password.data.password,"onUpdate:modelValue":a[9]||(a[9]=t=>e.dialog.password.data.password=t),validate:"password"},null,8,["label","modelValue"]),l(m,{type:"password",label:o.$t("globals.user_fields.password_confirm"),modelValue:e.dialog.password.data.password_confirmation,"onUpdate:modelValue":a[10]||(a[10]=t=>e.dialog.password.data.password_confirmation=t),validate:"password_confirmation"},null,8,["label","modelValue"])]),_:1}),l(n,{class:"row items-center justify-between"},{default:d(()=>[u(l(r,{flat:"",label:o.$t("globals.cancel")},null,8,["label"]),[[g]]),l(r,{color:"primary",loading:e.dialog.password.loading,onClick:e.change_password,label:o.$t("globals.change")},null,8,["loading","onClick","label"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(h,{modelValue:e.dialog.email.open,"onUpdate:modelValue":a[13]||(a[13]=t=>e.dialog.email.open=t)},{default:d(()=>[l(y,null,{default:d(()=>[l(V,null,{default:d(()=>[_("span",S,c(o.$t("pages.profile.change_email")),1),u(l(r,{flat:"",round:"",size:"12px",icon:"close"},null,512),[[g]])]),_:1}),l(n,{class:"column q-gap-md"},{default:d(()=>[e.dialog.email.sent?(p(),q("span",T,c(o.$t("pages.profile.email_change_sent")),1)):(p(),f(m,{key:1,type:"email",label:o.$t("globals.user_fields.email"),modelValue:e.dialog.email.data.email,"onUpdate:modelValue":a[12]||(a[12]=t=>e.dialog.email.data.email=t),validate:"email"},null,8,["label","modelValue"]))]),_:1}),l(n,{class:"row items-center justify-between"},{default:d(()=>[e.dialog.email.sent?u((p(),f(r,{key:0,flat:"",class:"q-ml-auto",label:o.$t("globals.close")},null,8,["label"])),[[g]]):(p(),q(I,{key:1},[u(l(r,{flat:"",label:o.$t("globals.cancel")},null,8,["label"]),[[g]]),l(r,{color:"primary",loading:e.dialog.email.loading,onClick:e.change_email,label:o.$t("globals.change")},null,8,["loading","onClick","label"])],64))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var H=N(M,[["render",x]]);export{H as default};
