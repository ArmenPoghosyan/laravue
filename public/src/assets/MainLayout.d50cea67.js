import{_ as z,b as N,f as l,r as t,o as c,c as _,w as o,ab as e,aR as C,y as j,g as V,t as m,aZ as y,bw as U,bx as G,d as I,e as J,F as O,aN as L,az as Q}from"./index.efdacdc2.js";import{C as K}from"./ClosePopup.7b950a27.js";const W={setup(){return{is_open:N({get:()=>l.store.state.app.media_popup.open,set:s=>l.store.commit("app/media_popup",{open:s,media:null})})}}};function X(a,s,r,n,h,v){const d=t("ap-button"),f=t("ap-img"),u=t("ap-card"),i=t("ap-dialog");return c(),_(i,{modelValue:n.is_open,"onUpdate:modelValue":s[0]||(s[0]=b=>n.is_open=b)},{default:o(()=>[e(u,{class:"fit bg-grey-9 relative-position",style:{"max-width":"90%","max-height":"75%"}},{default:o(()=>[C(e(d,{round:"",color:"white","text-color":"text",size:"12px",icon:"close",class:"absolute-top-right q-ma-md top"},null,512),[[K]]),e(f,{class:"fit",fit:"contain",src:a.state.app.media_popup.media},null,8,["src"])]),_:1})]),_:1},8,["modelValue"])}var Y=z(W,[["render",X]]);const ee={setup(){const a=N({get:()=>l.store.state.app.password_popup.open,set:n=>l.store.commit("app/password_popup",{open:n})}),s=j({loading:!1,data:{password:""}});async function r(){var h;s.value.loading=!0,l.clearErrors();const n=await l.store.dispatch("user/check_password",s.value.data);if(n.status){a.value=!1,s.value.data.password="";let v=(h=l.state.app.password_popup)==null?void 0:h.fn;v&&typeof v=="function"&&v(),l.store.commit("app/password_popup",{open:!1,fn:null})}else n.statusCode==422?l.setErrors(n.errors):l.$q.notify({type:"negative",message:l.$t("globals.errors.unknown")});s.value.loading=!1}return{state:s,is_open:a,check:r}}},ae={class:"text-h6 q-mr-auto"};function oe(a,s,r,n,h,v){const d=t("ap-button"),f=t("ap-dialog-header"),u=t("ap-card-section"),i=t("ap-input"),b=t("ap-dialog-card"),g=t("ap-dialog");return c(),_(g,{modelValue:n.is_open,"onUpdate:modelValue":s[1]||(s[1]=p=>n.is_open=p)},{default:o(()=>[e(b,{style:{"max-width":"500px"}},{default:o(()=>[e(f,null,{default:o(()=>[V("span",ae,m(a.$t("globals.popups.password.title")),1),C(e(d,{round:"",flat:"",icon:"close",size:"12px"},null,512),[[K]])]),_:1}),e(u,{class:"text-white bg-negative q-pa-md"},{default:o(()=>[y(m(a.$t("globals.popups.password.description")),1)]),_:1}),e(u,null,{default:o(()=>[e(i,{type:"password",modelValue:n.state.data.password,"onUpdate:modelValue":s[0]||(s[0]=p=>n.state.data.password=p),onKeypress:U(n.check,["enter"]),label:a.$t("globals.user_fields.password"),validate:"password"},null,8,["modelValue","onKeypress","label"])]),_:1}),e(u,{class:"row justify-between"},{default:o(()=>[C(e(d,{flat:"",label:a.$t("globals.cancel")},null,8,["label"]),[[K]]),e(d,{color:"primary",label:a.$t("globals.continue"),loading:n.state.loading,onClick:n.check},null,8,["label","loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}var te=z(ee,[["render",oe]]);const se={setup(){const a=j({loading:!1,open:!0,data:{password:"",password_confirmation:""}});async function s(){a.value.loading=!0,l.clearErrors();const r=await l.store.dispatch("user/change_password",a.value.data);r.status?(a.value.open=!1,a.value.data.password="",a.value.data.password_confirmation=""):r.statusCode==422?l.setErrors(r.errors):l.error((r==null?void 0:r.message)||l.label("globals.errors.unknown")),a.value.loading=!1}return{state:a,change_password:s}}},ne={class:"text-h6 q-mr-auto"},le={class:"row q-col-gutter-md"};function pe(a,s,r,n,h,v){const d=t("ap-dialog-header"),f=t("ap-input"),u=t("ap-card-section"),i=t("ap-button"),b=t("ap-dialog-card"),g=t("ap-dialog");return c(),_(g,{modelValue:n.state.open,"onUpdate:modelValue":s[2]||(s[2]=p=>n.state.open=p),persistent:""},{default:o(()=>[e(b,{style:{"max-width":"500px"}},{default:o(()=>[e(d,null,{default:o(()=>[V("span",ne,m(a.$t("globals.user_fields.change_password")),1)]),_:1}),e(u,null,{default:o(()=>[V("div",le,[e(f,{type:"password",class:"col-xs-12",modelValue:n.state.data.password,"onUpdate:modelValue":s[0]||(s[0]=p=>n.state.data.password=p),onKeypress:U(n.change_password,["enter"]),label:a.$t("globals.user_fields.password"),validate:"password"},null,8,["modelValue","onKeypress","label"]),e(f,{type:"password",class:"col-xs-12",modelValue:n.state.data.password_confirmation,"onUpdate:modelValue":s[1]||(s[1]=p=>n.state.data.password_confirmation=p),onKeypress:U(n.change_password,["enter"]),label:a.$t("globals.user_fields.password_confirm"),validate:"password_confirmation"},null,8,["modelValue","onKeypress","label"])])]),_:1}),e(u,{class:"row justify-end"},{default:o(()=>[e(i,{color:"primary",label:a.$t("globals.change"),loading:n.state.loading,onClick:n.change_password},null,8,["label","loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}var re=z(se,[["render",pe]]);const de=G({name:"MainLayout",components:{PasswordPopup:te,MediaPopup:Y,ChangePasswordPopup:re},setup(){const a=j(!1);function s(){a.value=!a.value}return{drawer:a,toggleDrawer:s}}}),ie={class:"column"},ce={class:"text-caption text-no-wrap"};function ue(a,s,r,n,h,v){const d=t("ap-button"),f=t("ap-link"),u=t("ap-img"),i=t("ap-icon"),b=t("ap-avatar"),g=t("ap-card-section"),p=t("ap-separator"),w=t("ap-item-section"),x=t("ap-item-label"),$=t("ap-item"),q=t("ap-list"),P=t("ap-card"),B=t("ap-menu"),D=t("ap-header"),M=t("ap-drawer"),F=t("router-view"),R=t("ap-page-container"),H=t("password-popup"),S=t("media-popup"),T=t("change-password-popup"),Z=t("ap-layout");return c(),_(Z,{view:"lHh Lpr lFf"},{default:o(()=>{var E;return[e(D,{elevated:"",class:"row items-center q-gap-sm bg-accent"},{default:o(()=>[e(d,{flat:"",round:"",icon:"menu","aria-label":"Menu",onClick:a.toggleDrawer},null,8,["onClick"]),e(f,{class:"text-h6 text-white text-no-underline"},{default:o(()=>[y(m(a.config.app.name),1)]),_:1}),e(d,{round:"",flat:"",class:"q-ml-auto"},{default:o(()=>[e(b,{bordered:"",class:"flex-shrink bg-white overflow-hidden",size:"36px"},{default:o(()=>[a.$user.avatar?(c(),_(u,{key:0,class:"fit",fit:"contain",src:a.media(a.$user.avatar,"s")},null,8,["src"])):(c(),_(i,{key:1,name:"sym_o_account_circle",class:"text-grey-6",size:"24px"}))]),_:1}),e(B,null,{default:o(()=>[e(P,{rounded:!1},{default:o(()=>[e(g,{class:"row no-wrap items-center q-gap-sm"},{default:o(()=>[e(b,{bordered:"",class:"flex-shrink flex flex-center bg-white",size:"40px"},{default:o(()=>[a.$user.avatar?(c(),_(u,{key:0,class:"fit",fit:"contain",src:a.media(a.$user.avatar,"s")},null,8,["src"])):(c(),_(i,{key:1,name:"sym_o_person",class:"text-grey-6",size:"24px"}))]),_:1}),V("div",ie,[V("span",ce,m(a.$user.full_name),1)])]),_:1}),e(p),e(g,{"no-padding":""},{default:o(()=>[e(q,{separator:""},{default:o(()=>[e($,{clickable:"",exact:"",to:{name:"profile.index"}},{default:o(()=>[e(w,{icon:""},{default:o(()=>[e(i,{name:"person",size:"24px"})]),_:1}),e(w,null,{default:o(()=>[e(x,null,{default:o(()=>[y(m(a.$t("pages.profile.title")),1)]),_:1})]),_:1})]),_:1},8,["to"]),e($,{clickable:"",onClick:a.logout},{default:o(()=>[e(w,{icon:""},{default:o(()=>[e(i,{name:"logout",size:"24px"})]),_:1}),e(w,null,{default:o(()=>[e(x,null,{default:o(()=>[y("Logout")]),_:1})]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(M,{modelValue:a.drawer,"onUpdate:modelValue":s[1]||(s[1]=k=>a.drawer=k),overlay:"",behavior:"mobile",bordered:""},{default:o(()=>[e(P,{flat:"",class:"fit column no-wrap"},{default:o(()=>[e(g,{class:"row items-center justify-between"},{default:o(()=>[e(f,{class:"text-no-underline text-secondary text-h6",to:{name:a.config.app.home}},{default:o(()=>[y(m(a.config.app.name),1)]),_:1},8,["to"]),e(d,{flat:"",round:"",icon:"close",size:"sm",onClick:s[0]||(s[0]=k=>a.drawer=!1)})]),_:1}),e(p),e(g,{"no-padding":"",class:"full-height"},{default:o(()=>[e(q,{separator:""},{default:o(()=>[e($,{clickable:"",exact:"",to:{name:"users.index"},"active-class":"bg-grey-3 text-primary"},{default:o(()=>[e(w,{icon:""},{default:o(()=>[e(i,{name:"sym_o_group",size:"24px"})]),_:1}),e(w,null,{default:o(()=>[e(x,null,{default:o(()=>[y(m(a.$t("pages.users.title")),1)]),_:1})]),_:1})]),_:1},8,["to"]),e($,{clickable:"",exact:"",to:{name:"localizations.index"},"active-class":"bg-grey-3 text-primary"},{default:o(()=>[e(w,{icon:""},{default:o(()=>[e(i,{name:"translate",size:"24px"})]),_:1}),e(w,null,{default:o(()=>[e(x,null,{default:o(()=>[y(m(a.$t("pages.localizations.title")),1)]),_:1})]),_:1})]),_:1},8,["to"])]),_:1})]),_:1}),e(p),e(g,null,{default:o(()=>[a.lists.languages.length>1?(c(),_(d,{key:0,rounded:"",flat:"",class:"q-ml-auto header__actionButton justify-self: start",icon:"language",size:"14px",label:a.current_locale.toUpperCase()},{default:o(()=>[e(B,{"transition-show":"jump-down","transition-hide":"jump-up",anchor:"top left",self:"bottom left",offset:[0,8]},{default:o(()=>[e(q,{separator:""},{default:o(()=>[(c(!0),I(O,null,J(a.lists.languages,(k,A)=>C((c(),_($,{key:A,clickable:"",onClick:_e=>a.set_locale(k.value),active:k.value==a.current_locale,"active-class":"bg-grey-3"},{default:o(()=>[e(w,null,{default:o(()=>[y(m(k.label),1)]),_:2},1024)]),_:2},1032,["onClick","active"])),[[Q]])),128))]),_:1})]),_:1})]),_:1},8,["label"])):L("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(R,null,{default:o(()=>[e(F)]),_:1}),e(H),e(S),(E=a.$user)!=null&&E.force_password_change?(c(),_(T,{key:0})):L("",!0)]}),_:1})}var ge=z(de,[["render",ue]]);export{ge as default};
